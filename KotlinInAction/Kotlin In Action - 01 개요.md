# Kotlin in Action

### What is Kotlin? Why Kotlin?

> A new programming language targeting the Java platform.
>
> 자바 플랫폼에서 돌아가는 새로운 프로그래밍 언어

#### 특징 1. 자바 코드와의 **상호운용성<sup>interoperability</sup>**이 **주목적<sup>Primary goal</sup>**

* 자바가 사용되고 있는 모든 용도에 적합하고, 간결하며 생산적인 안전한 대체언어 역할
* 기존 자바가 사용중인 곳은 대부분 활용 가능

#### 특징 2. 정적 타입<sup>Statically Typed</sup> 지정 언어

* 컴파일 타임에서 객체 필드, 메소드 등의 타입을 검증
  * **성능<sup>Performance</sup>** : 실행 시점에 어떤 메소드를 호출할지 알아내는 과정이 필요 없으므로 메소드 호출이 빠름
  * **신뢰성<sup>Reliability</sup>** : 컴파일 타임에 정확성<sup>Correctness</sup>을 검증하기 때문에 런타임에 오류가 날 확률이 적음
  * **유지보수성<sup>Maintainability</sup>** : 객체가 어떤 타입에 속하는지 알 수 있어서 처음보는 코드를 다루기 쉬움
  * **도구 지원<sup>Tool support</sup>** : 더욱 안전한 리팩토링, 더욱 정확한 코드 완성 제공 가능.
* 그렇다면 동적 타입<sup>Dynamically Typed</sup> 지정 언어란?
  * JVM에서는 그루비<sup>Groovy</sup>, JRuby가 대표적
  * 무슨 타입의 값이든 변수에 넣을 수 있고, 타입 검증이 컴파일타임이 아닌 런타임<sup>Runtime</sup>에서 일어남
  * 장점
    * 코드가 더 짧아진다
    * 데이터 구조를 유연하게 짤 수 있다.
  * 단점
    * 잘못된 값이 들어가도 직접 실행이 되어야 걸러낼 수 있다.
* **자바도 정적 타입 지정 언어인데 무엇이 다른가?**
  1. 모든 변수의 타입을 직접 명시해줄 필요가 없음.
     * **타입 추론<sup>Type Inference</sup>** 기능 지원 : 코틀린 컴파일러가 문맥을 파악해 타입을 유추함
  2. **널이 될 수 있는 타입<sup>Nullable Type</sup> 지원**
     * 컴파일 타임에서 Null Pointer Exception이 발생하는지 여부를 검사할 수 있어짐
  3. **함수 타입<sup>function type</sup> 지원**
     * 함수형 프로그래밍에서 지원하는 함수 타입을 지원

#### 특징 3. 함수형 프로그래밍과 객체지향 프로그래밍

* 함수형 프로그래밍<sup>Funtional Programming</sup>이란?

  * 일급 함수<sup>First-class Functions</sup>
    * 함수를 일반 값처럼 다룰 수 있음
      * 변수에 저장
      * 파라미터로 전달
      * 새로운 함수를 리턴하는 함수
  * 불변성<sup>Immutability</sup>
    * 한번 생성되면 내부 상태가 절대로 변하지 않는 불변 객체를 사용
      * `val` 키워드를 사용한 변수 선언
  * 사이드 이펙트<sup>Side Effect</sup> 없음
    * 입력이 같으면 항상 같은 출력이 보장
    * 다른 객체의 상태를 변경하지 않음
    * 함수 외부나 바깥 환경과 상호작용 하지 않는 순수 함수<sup>pure function</sup> 사용

* 왜 함수형 프로그래밍을 할까?

  1. 간결하다

     * 함수를 값처럼 사용할 수 있어서 강력하게 추상화 할 수 있다.
     * 따라서, 코드 중복을 많이 줄일 수 있다.

     ```kotlin
     fun findAlice() = findPerson { it.name == "Alice" }
     fun findBob() = findPerson { it.name == "Bob" }
     ```

  2. 다중 스레드 환경에서 안전<sup>Thread-safe</sup>하다

     * 불변<sup>Immutable</sup> 데이터 구조와 순수 함수를 사용하면 같은 데이터를 여러 스레드에서 변경할 수 없다.
     * 복잡한 동기화 정책이 필요없음

  3. 테스트가 용이하다.

     * 사이드 이펙트가 있는 함수는 전체 환경을 구성하는 셋업 코드<sup>Setup Code</sup>가 필요하지만 순수 함수는 그런 과정이 필요없이 독립적으로 테스트 할 수 있다.

* 코틀린의 함수형 프로그래밍 지원

  * 함수 타입 지원
  * 람다 식<sup>Lambda Expression</sup> 지원
  * 데이터 클래스<sup>data class</sup>로 불변적인 값 객체를 간편하게 생성
  * 객체와 컬렉션을 함수형 스타일로 다룰 수 있는 API 기본 제공

#### 특징 4. 무료 오픈소스

* Apache 2.0 License
* Github을 통한 개발 진행
* 수많은 IDE 활용 가능



### Kotlin을 사용하는 분야

#### 1. 코틀린 서버 프로그래밍

* 서버 프로그래밍이란?

  * 브라우저에 HTML 페이지를 돌려주는 웹 애플리케이션
  * 모바일 애플리케이션에게 HTTP를 통해 JSON API를 제공하는 백엔드<sup>Backend</sup> 애플리케이션
  * RPC 프로토콜을 통해 서로 통신하는 작은 서비스들로 이뤄진 마이크로서비스

* 코틀린을 사용한 서버 프로그래밍의 이점

  * 코틀린 빌더 패턴<sup>Builder Pattern</sup>을 통해 간결한 구문 제공

    ```kotlin
    fun renderPersonList(persons: Collection<Person>) =
    	createHTML().table {
        for (person in persons) { // 일반적인 코틀린 for 루프
          tr {
            td { +person.name }
            td { +person.age }
          }
        }
      }
    ```

    * 보다 직관적이게 HTML 태그를 변환할 함수를 조합하기 쉬움
  * 영속성<sup>Persistence</sup> 프레임워크 제공
    
    * 젯브레인에서 제공하는 `Exposed` 프레임워크는 SQL 구조를 기술할 수 있는 읽기 쉬운 DSL 제공
    * 완전한 타입 검사를 지원해서 DB 쿼리를 실행할 수 있음

#### 2. 코틀린 안드로이드 프로그래밍

* ~~코틀린 팀이 만든 `Anko` 라이브러리는 수많은 안드로이드 API에 대한 어댑터 제공~~ *(현재는 Deprecated되었습니다)*
* Null Pointer Exception을 컴파일 타임에서 처리하기 때문에 앱의 신뢰성이 높아진다



### Kotlin의 철학

#### 1. 실용성

* 연구를 위한 언어가 아니다.
* 실무에서 겪은 문제들에 대한 피드백을 반영한 언어
* 언어뿐만 아니라 도구도 강조한다.
  * 편리한 개발 환경도 생산성 향상에 필수적이다.
  * IDE의 코틀린 언어 지원이 중요한 역할을 한다.
    * 내가 작성한 코드를 코틀린 철학에 맞게 자동 수정 되는 걸 보고 많이 배울 수 있다.

#### 2. 간결성

* 코드를 새로 작성하는 시간보다 **코드를 읽는 시간**이 더 길다.
* 간단하고 간결한 코드는 내용을 파악하기 쉬워진다.
* Getter, Setter, 생성자 파라미터 등 의미없이 번거로운 일들을 최소한으로 줄이려고 노력
* Collection에서 원소를 찾는 등 일반적인 코드를 작성하는데 필요한 코드도 상당히 많다.

#### 3. 안전성

* 안전성과 생산성 사이에는 트레이드오프<sup>Trade-off</sup> 관계가 성립한다.
  * 어떻게 작동해야하는지 상세히 제공해야만 오류 검증이 가능해진다.
  * 많은 정보를 제공해야하므로 생산성이 떨어지게 된다.
* 타입 추론, Nullable 타입 제공 등으로 적은 코드를 작성할 뿐만 아니라, 컴파일 타임에서 많은 오류를 검증할 수 있어진다.
* 엄격하게 타입을 관리하기 때문에 타입 변환<sup>Cast</sup> 전에 타입을 미리 검사하지 않으면 `ClassCastException`이 발생할 수 있다.

#### 4. 상호운용성

* 기존 라이브러리를 그대로 사용할 수 있다.
  * 자바 메소드 호출, 클래스 상속, 인터페이스 구현, 자바 어노테이션<sup>Annotation</sup> 등을 코틀린 코드에 적용이 가능하다. 
* **코틀린은 자체 컬렉션 라이브러리를 제공하지 않는다.**
  * 자바 표준 라이브러리 클래스에 의존하고, 더 쉽게 활용할 수 있게 몇 가지 기능을 추가해준 것이다.
  * 따라서, 별다른 변환 작업이 필요없어지므로 아무런 비용이 발생하지 않는다.
* 자바와 코틀린 소스 파일이 섞여있어도 컴파일이 가능하다.



### 코틀린 빌드과정

![image-20200325223708795](Kotlin%20In%20Action%20-%2001%20%E1%84%80%E1%85%A2%E1%84%8B%E1%85%AD.assets/image-20200325223708795.png)